import{a0 as N,r as m,j as e,x as v,ap as C,a2 as S,I as b,t as c}from"./vendor-react-BtnKiOrb.js";import{c as k}from"./chartink-CNu9cgRP.js";import{A as q,a as w}from"./alert-wYC2wlrk.js";import{B as d}from"./index-B87L8flj.js";import{C as F,b as E,c as A,d as I,a as L}from"./card-DaWziHEX.js";import{I as o}from"./input-fipynuSj.js";import{L as l}from"./label-C7siTT_u.js";import{S as D,a as T,b as B,c as O,d as y}from"./select-Dmte1kG2.js";function G(){const h=N(),[u,x]=m.useState(!1),[t,r]=m.useState({name:"",strategy_type:"intraday",start_time:"09:15",end_time:"15:00",squareoff_time:"15:15"}),[n,p]=m.useState({}),j=()=>{const a={};if(t.name.trim()?t.name.length<3||t.name.length>50?a.name="Name must be between 3 and 50 characters":/^[a-zA-Z0-9\s\-_]+$/.test(t.name)||(a.name="Name can only contain letters, numbers, spaces, hyphens, and underscores"):a.name="Strategy name is required",t.strategy_type==="intraday"){const s=t.start_time,i=t.end_time,g=t.squareoff_time;!s||!i||!g?a.time="All time fields are required for intraday strategies":s>=i?a.time="Start time must be before end time":i>=g&&(a.time="End time must be before square off time")}return p(a),Object.keys(a).length===0},_=async a=>{if(a.preventDefault(),!j()){c.error("Please fix the form errors");return}try{x(!0);const s=await k.createStrategy({name:t.name,strategy_type:t.strategy_type,...t.strategy_type==="intraday"&&{start_time:t.start_time,end_time:t.end_time,squareoff_time:t.squareoff_time}});s.status==="success"?(c.success("Chartink strategy created successfully"),h(`/chartink/${s.data?.strategy_id}`)):c.error(s.message||"Failed to create strategy")}catch(s){console.error("Failed to create strategy:",s);const i=s instanceof Error?s.message:"Failed to create strategy";c.error(i)}finally{x(!1)}},f=t.name?`chartink_${t.name.toLowerCase().replace(/\s+/g,"_")}`:"";return e.jsxs("div",{className:"container mx-auto py-6 max-w-2xl space-y-6",children:[e.jsx(d,{variant:"ghost",asChild:!0,children:e.jsxs(v,{to:"/chartink",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Back to Chartink Strategies"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Create Chartink Strategy"}),e.jsx("p",{className:"text-muted-foreground",children:"Set up a new Chartink webhook strategy to receive screener alerts"})]}),e.jsxs(F,{children:[e.jsxs(E,{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5"}),"Strategy Details"]}),e.jsx(I,{children:"Configure your Chartink strategy settings (NSE/BSE only)"})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Strategy Name"}),e.jsx(o,{id:"name",placeholder:"My Chartink Strategy",value:t.name,onChange:a=>r({...t,name:a.target.value}),className:n.name?"border-red-500":""}),n.name&&e.jsx("p",{className:"text-sm text-red-500",children:n.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"3-50 characters. Letters, numbers, spaces, hyphens, and underscores only."})]}),f&&e.jsxs(q,{children:[e.jsx(b,{className:"h-4 w-4"}),e.jsxs(w,{children:["Final strategy name:"," ",e.jsx("code",{className:"bg-muted px-1 rounded font-mono",children:f})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"strategy_type",children:"Strategy Type"}),e.jsxs(D,{value:t.strategy_type,onValueChange:a=>r({...t,strategy_type:a}),children:[e.jsx(T,{children:e.jsx(B,{placeholder:"Select type"})}),e.jsxs(O,{children:[e.jsx(y,{value:"intraday",children:"Intraday"}),e.jsx(y,{value:"positional",children:"Positional"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Intraday strategies have trading hours and auto square-off."})]}),t.strategy_type==="intraday"&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsx("h4",{className:"font-medium",children:"Trading Hours"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"start_time",children:"Start Time"}),e.jsx(o,{id:"start_time",type:"time",value:t.start_time,onChange:a=>r({...t,start_time:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"end_time",children:"End Time"}),e.jsx(o,{id:"end_time",type:"time",value:t.end_time,onChange:a=>r({...t,end_time:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"squareoff_time",children:"Square Off"}),e.jsx(o,{id:"squareoff_time",type:"time",value:t.squareoff_time,onChange:a=>r({...t,squareoff_time:a.target.value})})]})]}),n.time&&e.jsx("p",{className:"text-sm text-red-500",children:n.time}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Orders will only be placed during trading hours. Positions will be squared off at the specified time."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(d,{type:"button",variant:"outline",className:"flex-1",onClick:()=>h("/chartink"),children:"Cancel"}),e.jsx(d,{type:"submit",className:"flex-1",disabled:u,children:u?"Creating...":"Create Strategy"})]})]})})]})]})}export{G as default};
